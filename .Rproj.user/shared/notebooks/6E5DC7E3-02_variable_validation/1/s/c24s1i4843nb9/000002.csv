"0","preterm_fix <- read_csv(""metadata/preterm_fix.csv"") %>%"
"0","  rename(lab = labid) %>%"
"0","  select(-filename)"
"0",""
"0","#validate lab names"
"0","see_if(all(d$lab %in% preterm_fix$lab))"
"1","[1]"
"1"," TRUE"
"1","
"
"0","d <- d %>%"
"0","  left_join(preterm_fix)"
"0",""
"0","d <- d %>%"
"0","  mutate(days_preterm_fixed = case_when("
"0","    preterm_fix == ""all_full_term"" ~ NA_integer_,"
"0","    preterm_fix == ""40"" ~ as.integer(days_preterm - 21),"
"0","    preterm_fix == ""41"" ~ as.integer(days_preterm - 28),"
"0","    preterm_fix == ""37"" ~ as.integer(days_preterm),"
"0","    TRUE ~ as.integer(days_preterm)))"
"0",""
"0","# remove unnecessary column"
"0","d <- select(d, -preterm_fix)"
"0",""
"0","# classify infants as preterm based on days"
"0","# includes one fix for lab: ileap, subid: e48s006 who doesn't have anything in the `days_preterm` column but should be classified as preterm."
"0","d <- d %>% "
"0","  mutate(full_term_by_days = case_when("
"0","    days_preterm_fixed <= 0 ~ TRUE,"
"0","    is.na(days_preterm_fixed) ~ TRUE,"
"0","    days_preterm_fixed > 0 ~ FALSE,"
"0","    TRUE ~ NA"
"0","  ))"
"0",""
"0","# How many infants are classified as preterm by this method"
"0","table(d[!duplicated(d$subid),]$full_term_by_days)"
"1","
"
"1","FALSE "
"1"," TRUE "
"1","
"
"1","   12 "
"1","  694 "
"1","
"
"0","preterm <- d %>% filter(full_term_by_days==FALSE) %>% select(lab, subid, lang1, lang2, lang3, lang4, lang1_exposure, lang2_exposure, lang3_exposure, lang4_exposure, bilingual, bilingual_exposure, age_days) %>% "
"0","  mutate(age_group = age_days/(365.25/12)) %>% "
"0","  unique()"
"0","#Note most of the pre-term infants are not bilinguals (not 25-75 criteria), only 4 pre-term bilingual infants were tested"
"0",""
